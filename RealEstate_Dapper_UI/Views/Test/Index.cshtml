@using Microsoft.AspNetCore.SignalR

@{
    ViewData["Title"] = "Index";
}
<script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>

@section Scripts
{
    <div class="content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <script type="text/javascript">
                            $(document).ready(() => {
                                var connection = new signalR.HubConnectionBuilder().withUrl("https://localhost:44324/SignalRHub").build();
                                $("#connstatus").text(connection.state);
                                connection.start().then(() => {
                                    $("#connstatus").text(connection.state);
                                    setInterval(() => {
                                        connection.invoke("SendActiveCategoryCount");
                                        connection.invoke("SendActiveEmployeeCount");
                                        connection.invoke("SendApartmentCount");
                                        connection.invoke("SendAverageProductPriceByRent");
                                        connection.invoke("SendAverageProductPriceBySale");
                                        connection.invoke("SendAverageRoomCount");
                                        connection.invoke("SendCategoryCount");
                                        connection.invoke("SendCategoryNameByMaxProductCount");
                                        connection.invoke("SendCityNameByMaxProductCount");
                                        connection.invoke("SendDifferentCityCount");
                                        connection.invoke("SendEmployeeNameByMaxProductCount");
                                        connection.invoke("SendLastProductPrice");
                                        connection.invoke("SendNewestBuildingYear");
                                        connection.invoke("SendOldestBuildingYear");
                                        connection.invoke("SendPassiveCategoryCount");
                                        connection.invoke("SendProductCount");
                                    }, 1000)

                                }).catch((err) => { console.log(err) });

                                connection.on("ReceiveActiveCategoryCount", (value) => {
                                    debugger;
                                    $("#ActiveCategoryCount").text(value);
                                });

                                connection.on("ReceiveActiveEmployeeCount", (value) => {
                                    $("#ActiveEmployeeCount").text(value);
                                });

                                connection.on("ReceiveApartmentCount", (value) => {
                                    $("#ApartmentCount").text(value);
                                });

                                connection.on("ReceiveAverageProductPriceByRent", (value) => {
                                    $("#AverageProductPriceByRent").text(value);
                                });

                                connection.on("ReceiveAverageProductPriceBySale", (value) => {
                                    $("#AverageProductPriceBySale").text(value);
                                });

                                connection.on("ReceiveCategoryCount", (value) => {
                                    $("#categorycount").text(value);
                                });

                                connection.on("ReceiveAverageRoomCount", (value) => {
                                    $("#AverageRoomCount").text(value);
                                });

                                connection.on("ReceiveCategoryNameByMaxProductCount", (value) => {
                                    $("#CategoryNameByMaxProductCount").text(value);
                                });

                                connection.on("ReceiveCityNameByMaxProductCount", (value) => {
                                    $("#CityNameByMaxProductCount").text(value);
                                });

                                connection.on("ReceiveDifferentCityCount", (value) => {
                                    $("#DifferentCityCount").text(value);
                                });

                                connection.on("ReceiveEmployeeNameByMaxProductCount", (value) => {
                                    $("#employeename").text(value);
                                });

                                connection.on("ReceiveLastProductPrice", (value) => {
                                    $("#LastProductPrice").text(value);
                                });

                                connection.on("ReceiveNewestBuildingYear", (value) => {
                                    $("#NewestBuildingYear").text(value);
                                });

                                connection.on("ReceiveOldestBuildingYear", (value) => {
                                    $("#OldestBuildingYear").text(value);
                                });

                                connection.on("ReceivePassiveCategoryCount", (value) => {
                                    $("#PassiveCategoryCount").text(value);
                                });

                                connection.on("ReceiveProductCount", (value) => {
                                    $("#ProductCount").text(value);
                                });
                            });

                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Bağlantı Durumu:<strong id="connstatus"></strong></div>
    </div>"
</div>

<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-info">Aktif Kategori:<strong id="ActiveCategoryCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Aktif Personel:<strong id="ActiveEmployeeCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Daire İlan Sayısı:<strong id="ApartmentCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Ortalama Kira:<strong id="AverageProductPriceByRent"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-info">Ortalama Satış Fiyatı:<strong id="AverageProductPriceBySale"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Ortalama Oda Adet:<strong id="AverageRoomCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Kategori Sayısı:<strong id="categorycount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">En İyi Kategori:<strong id="CategoryNameByMaxProductCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">İlan-Şehir:<strong id="CityNameByMaxProductCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-info">Şehir Sayısı:<strong id="DifferentCityCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">En İyi Personel:<strong id="employeename"></strong></div>
    </div>
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-info">Son İlan Fiyatı:<strong id="LastProductPrice"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-info">En Yeni Bina Yılı:<strong id="NewestBuildingYear"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">En Eski Bina Yılı:<strong id="OldestBuildingYear"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Pasif Kategori:<strong id="PassiveCategoryCount"></strong></div>
    </div>"
</div>
<div class="row">
    <div class="col-md-8 offset-2">
        <div class="alert alert-warning">Toplam İlan:<strong id="ProductCount"></strong></div>
    </div>"
</div>

